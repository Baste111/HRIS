<template>
	<v-app>
		<v-navigation-drawer
				app
				color="white"
				light
				v-model="isDrawerOpen"
		>
			<v-list rounded two-line>
				<v-list-item>
					<v-list-item-avatar :size="35">
						<v-img :src="require('../assets/udmLogo.png')"></v-img>
					</v-list-item-avatar>
					<v-list-item-content>
						<v-list-item-title class="font-weight-bold">John D. Doe</v-list-item-title>
						<v-list-item-subtitle class="font-weight-bold">19-19-101</v-list-item-subtitle>
						<v-list-item-subtitle>Faculty</v-list-item-subtitle>
					</v-list-item-content>
				</v-list-item>
			</v-list>
			<v-divider></v-divider>
			<v-subheader>Available Actions</v-subheader>
			<v-list dense rounded>
				<template v-for="(action, index) in userActions">
					<v-list-item
							:key="index"
							:to="action.route"
							active-class="primary white--text"
							v-if="action.subActions.length <= 0"
					>
						<v-list-item-action>
							<v-icon>mdi-{{ action.icon }}</v-icon>
						</v-list-item-action>
						<v-list-item-content>
							<v-list-item-title>
								{{ action.name }}
							</v-list-item-title>
						</v-list-item-content>
					</v-list-item>
					<v-list-group :key="index" :prepend-icon="`mdi-${action.icon}`" v-else>
						<template v-slot:activator>
							<v-list-item-title
							>{{ action.name }}
							</v-list-item-title>
						</template>
						<template v-for="(subAction, subActionIndex) in action.subActions">
							<v-list-item :key="subActionIndex" :to="subAction.route" active-class="primary white--text">
								<v-list-item-action>
									<v-icon>mdi-{{ subAction.icon }}</v-icon>
								</v-list-item-action>
								<v-list-item-content>
									<v-list-item-title
									>{{ subAction.name }}
									</v-list-item-title>
								</v-list-item-content>
							</v-list-item>
						</template>
					</v-list-group>
				</template>
			</v-list>
		</v-navigation-drawer>
		<v-app-bar
				:elevation="1"
				app
				color="white"
				light
		>
			<v-app-bar-nav-icon @click.stop="isDrawerOpen = !isDrawerOpen"></v-app-bar-nav-icon>
			<v-icon class="mx-4">fab fa-youtube</v-icon>
			<v-spacer></v-spacer>
			<generic-notification></generic-notification>
			<v-menu offset-y>
				<template v-slot:activator="{ on }">
					<v-btn color="transparent" dark depressed exact v-on="on">
						<v-avatar :size="30">
							<v-img src="https://firebasestorage.googleapis.com/v0/b/portfolio-77930.appspot.com/o/resource%2FmyPicture.jpeg?alt=media&token=6b7c665c-60a0-4c59-a3b6-3bdc72c68fbe"></v-img>
						</v-avatar>
					</v-btn>
				</template>
				<v-list>
					<v-list-item @click="purgeAuth" exact>Logout</v-list-item>
				</v-list>
			</v-menu>
		</v-app-bar>
		<v-content>
			<v-container>
				<router-view></router-view>
			</v-container>
			<global-notification></global-notification>
		</v-content>
	</v-app>
</template>
<script>
    import GenericNotification from "../components/generic/Notification";
    import GlobalNotification from "../components/global/Notification";

    export default {
        name: "home-layout",
        components: {GlobalNotification, GenericNotification},
        data() {
            return {
                isDrawerOpen: true,
            };
        },

		computed: {
            userActions() {
                return this.$store.state.auth.userActions;
			},

			isAuthenticated() {
                return this.$store.state.auth.isAuthenticated;
			}
		},

		methods: {
            purgeAuth() {
                this.$store.dispatch('purgeAuth');
                this.$router.push({name: 'login'});
			}
		},

		created() {
            // if (!this.isAuthenticated) return this.$router.push({name: 'login'});
        }
    };
</script>